


<!doctype html>
<html lang="en" class="no-js">
  <head>
    


<meta charset="utf-8">




<!-- begin SEO -->









<title>Extract Raster Values at Point Locations in Python | Earth Data Science - Earth Lab </title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Earth Data Science - Earth Lab">
<meta property="og:title" content="Extract Raster Values at Point Locations in Python">


  <link rel="canonical" href="http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/extract-data-from-raster/">
  <meta property="og:url" content="http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/extract-data-from-raster/">



  <meta content="For many scientific analyses, it is helpful to be able to select raster pixels based on their relationship to a vector dataset (e.g. locations, boundaries). Learn how to extract data from a raster dataset using a vector dataset." name="description">
  <meta property="og:description" content="For many scientific analyses, it is helpful to be able to select raster pixels based on their relationship to a vector dataset (e.g. locations, boundaries). Learn how to extract data from a raster dataset using a vector dataset.">


<!-- twitter cards -->

  <meta name="twitter:site" content="@earthlabcu">
  <meta name="twitter:title" content="Extract Raster Values at Point Locations in Python">
  <meta name="twitter:description" content="For many scientific analyses, it is helpful to be able to select raster pixels based on their relationship to a vector dataset (e.g. locations, boundaries). Learn how to extract data from a raster dataset using a vector dataset.">
  <meta name="twitter:url" content="http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/extract-data-from-raster/">

  
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="https://earthdatascience.org/images/earth_sm_twit.png">
    <meta name="twitter:image:alt" content="The Earthlab Logo - image of a globe with courses, lessons and tutorials">

    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2016-12-06T00:00:00-07:00">
  
    <link rel="next" href="http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/summarize-and-compare-lidar-insitu-tree-height/" title="Compare Lidar to Measured Tree Height">
  
  
    <link rel="prev" href="http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/" title="Compare Lidar With Human Measured Tree Heights - Remote Sensing Uncertainty">
  





  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Earth Analytics",
      "url" : "http://localhost:4000",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Earth Data Science - Earth Lab Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="LfpevjsE0wlELv5KKOZv1T2RhRimGSiRckWv5ZC19GU" />
<!-- don't use the old cataloged meta tags -->
<meta name="googlebot" content="noodp">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>


<!-- For all browsers
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">-->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->


    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/clipboard@1/dist/clipboard.min.js"></script>

    <script src="http://localhost:4000/assets/js/copy-code.js"></script>
  </head>

  <body>


    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<!-- search bar begin  - turning off for now-->

<div class="search">
<form role="search" method="get" action="http://localhost:4000/search/">
    <input id="q" name="q"
           placeholder="Search earth data science site" type="text">
</form>
<!--<span class='cu-boulder'><a href="http://www.colorado.edu/earthlab" target="_blank">Earth Lab University of Colorado - Boulder Home </a></span> -->
</div>


<!-- search bar END -->

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://localhost:4000/"><img src="/images/earth-lab-logo.png" alt="Earth Lab - Earth Data Science" style="height:80%;width:85%"></a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/tutorials/">Tutorials</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/courses/">Courses</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/workshops/">Workshops</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/tools/">Tools</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/blog/">Blog</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/about/">About</a></li>
          

        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    



  <div class="page__hero--overlay" style=" background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('http://localhost:4000/images/header-images/earth-data-analytics-professional-certificate-banner.jpg');">
  <div class="wrapper">
        <h1 class="page__title" itemprop="headline">
          Earth Data Analytics Online Certificate
        </h1>
        <p><a href="http://bit.ly/2jc5SXy" target = "_blank" class="btn btn--light-outline btn--large">Enroll now! Learn more.</a></p>
  </div>
</div>





  
    













<nav class="breadcrumbs" role="menubar" aria-label="breadcrumbs">
 <ol itemscope itemtype="http://schema.org/BreadcrumbList">
 <a href="http://localhost:4000"></a>
 
 
 <!-- there is an offset of 1 so subtract 2 from the final crumb number-->
 
   
   
     <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
       <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
       <meta itemprop="position" content="1" />
     </li>
     <span class="sep">/</span>
   
    
        
        <li><a href="http://localhost:4000/courses/">Courses </a>
        <meta itemprop="position" content="2" />
        <span class="sep">/</span></li>
    
  
   
    
        
        <li><a href="http://localhost:4000/courses/use-data-open-source-python/">Use data open source python </a>
        <meta itemprop="position" content="3" />
        <span class="sep">/</span></li>
    
  
   
    
        
        <li><a href="http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/">Spatial data applications </a>
        <meta itemprop="position" content="4" />
        <span class="sep">/</span></li>
    
  
   
    
        
        <li><a href="http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/">Lidar remote sensing uncertainty </a>
        <meta itemprop="position" content="5" />
        <span class="sep">/</span></li>
    
  
   
    
        <li class="current">Extract Raster Values at Point Locations in Python</li>
    
  
</ol>
</nav>

<!-- from min mistakes -->




  


<div id="main" role="main">
  



  <div class="sidebar sticky">
  
  
    
      
      
      
    
    


    

    
     <!--  Might be able to delete this This is the code that populates the side bar navigation if there is a class-->
      







<!-- make sure we're only grabbing pages for the course -->



<!--<h3>Week 4 Lessons</h3>-->
<!-- i don't think the code below is used as modules is defined lower down as well. -->

<!-- This is how modules are sorted on the left hand side bar -->






<h5><a href="http://localhost:4000/courses/intermediate-earth-data-science-textbook/" ><i class="fa fa-home" aria-hidden="true"></i> Intermediate earth data science textbook</a></h5>

<!-- Just get the pages from this course -->






<nav class="nav__list">







<ul>
  <li><span class="nav__sub-title"><i class="fa fa-book" aria-hidden="true"></i> Units</span>
   <ul>

       

        

            <!-- Only list the week if it's not the week for the current landing page -->
            
                <li> <b>SECTION 1 <a href="http://localhost:4000/courses/use-data-open-source-python/use-time-series-data-in-python/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
                 TIME SERIES DATA IN PYTHON</a></b>
                </li>

                    <!-- list the chapters for each section  updating this to show a chapter number if it's a textbook-->
                    
                     <ul>
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/use-time-series-data-in-python/introduction-to-time-series-in-pandas-python/"> Chapter 1:   Time Series Data in Pandas </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/use-time-series-data-in-python/floods-return-period-and-probability/"> Chapter 1.5:   Flood Returns Period Analysis in Python </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                    </ul>


            

            <!-- This is for the activate section in the nav which is grey -->

            

    

            <!-- Only list the week if it's not the week for the current landing page -->
            
                <li> <b>SECTION 2 <a href="http://localhost:4000/courses/use-data-open-source-python/intro-vector-data-python/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
                 INTRO TO SPATIAL VECTOR DATA IN PYTHON</a></b>
                </li>

                    <!-- list the chapters for each section  updating this to show a chapter number if it's a textbook-->
                    
                     <ul>
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/intro-vector-data-python/spatial-data-vector-shapefiles/"> Chapter 2:   Spatial Data in Python </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/intro-vector-data-python/vector-data-processing/"> Chapter 3:   Processing Spatial Vector Data in Python </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                    </ul>


            

            <!-- This is for the activate section in the nav which is grey -->

            

    

            <!-- Only list the week if it's not the week for the current landing page -->
            
                <li> <b>SECTION 3 <a href="http://localhost:4000/courses/use-data-open-source-python/intro-raster-data-python/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
                 INTRODUCTION TO RASTER DATA IN PYTHON</a></b>
                </li>

                    <!-- list the chapters for each section  updating this to show a chapter number if it's a textbook-->
                    
                     <ul>
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/intro-raster-data-python/fundamentals-raster-data/"> Chapter 4:   Intro to Raster Data in Python </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/intro-raster-data-python/raster-data-processing/"> Chapter 5:   Processing Raster Data in Python </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                    </ul>


            

            <!-- This is for the activate section in the nav which is grey -->

            

    

            <!-- Only list the week if it's not the week for the current landing page -->
            

            <!-- This is for the activate section in the nav which is grey -->

            
                
                    <li class='active-section'> <a href="http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/"><i class="fa fa-folder-open" aria-hidden="true"></i>
                     4. SPATIAL DATA APPLICATIONS IN PYTHON</a></li>

            

<div class='active-menu'>
      <ul>
        
        <!-- Note that class-order allows you to sort modules by class order if there are more than 1 in a class -->
        

        

        

        
        
        <!-- If it's a textbook with a chapter number write "chapter", else assume it is a week -->

          <li><span class="nav__sub-title grey"><i class="fa fa-caret-down" aria-hidden="true"></i>   Chapter 6 Uncertainty in remote sensing data  </span></li>
        <ul>

      
      <!-- count lessons -->

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/><!--4.1 --> - Remote Sensing Uncertainty</a></li>
          
          

        
        
        
          
          <li><a href= http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/extract-data-from-raster/ class='active'> <!--4.2 -->- Extract Data From Raster</a></li>
          
          

        
        
        
          
          <li><a href= http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/summarize-and-compare-lidar-insitu-tree-height/><!--4.3 --> - Compare Lidar to Measured Tree Height</a></li>
          
          

        
        
        
          
          <li><a href= http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/compare-lidar-and-measured-tree-height-regression/><!--4.4 --> - Regression to Compare Variables</a></li>
          
          

        
       </ul>
        

        
      </ul>

      <!-- BEGIN Learn how to lessons -->
       <ul>
         
         
       </ul>


     </div>


      <!-- END BEGIN Learn how to lessons -->

      <!--  -->
      

    

            <!-- Only list the week if it's not the week for the current landing page -->
            
                <li> <b>SECTION 5 <a href="http://localhost:4000/courses/use-data-open-source-python/multispectral-remote-sensing/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
                 MULTISPECTRAL REMOTE SENSING DATA IN PYTHON</a></b>
                </li>

                    <!-- list the chapters for each section  updating this to show a chapter number if it's a textbook-->
                    
                     <ul>
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/multispectral-remote-sensing/intro-multispectral-data/"> Chapter 7:   Intro to Multispectral Remote Sensing Data </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/multispectral-remote-sensing/intro-naip/"> Chapter 8:   NAIP </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/multispectral-remote-sensing/landsat-in-Python/"> Chapter 9:   Landsat Data </a>
                                </li>
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/multispectral-remote-sensing/modis-data-in-python/"> Chapter 10:   MODIS Data </a>
                                </li>
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/multispectral-remote-sensing/vegetation-indices-in-python/"> Chapter 11:   Calculate Vegetation Indices in Python </a>
                                </li>
                            
                        
                    </ul>


            

            <!-- This is for the activate section in the nav which is grey -->

            

    

            <!-- Only list the week if it's not the week for the current landing page -->
            
                <li> <b>SECTION 6 <a href="http://localhost:4000/courses/use-data-open-source-python/hierarchical-data-formats-hdf/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
                 INTRODUCTION TO HIERARCHICAL DATA FORMATS IN PYTHON</a></b>
                </li>

                    <!-- list the chapters for each section  updating this to show a chapter number if it's a textbook-->
                    
                     <ul>
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/hierarchical-data-formats-hdf/intro-to-hdf4/"> Chapter 12:   HDF4 </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/hierarchical-data-formats-hdf/intro-to-climate-data/"> Chapter 13:   NETCDF </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                    </ul>


            

            <!-- This is for the activate section in the nav which is grey -->

            

    

            <!-- Only list the week if it's not the week for the current landing page -->
            
                <li> <b>SECTION 7 <a href="http://localhost:4000/courses/use-data-open-source-python/intro-to-apis/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
                 INTRODUCTION TO API DATA ACCESS IN OPEN SOURCE PYTHON</a></b>
                </li>

                    <!-- list the chapters for each section  updating this to show a chapter number if it's a textbook-->
                    
                     <ul>
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/intro-to-apis/apis-in-python/"> Chapter 15:   APIs </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/intro-to-apis/social-media-text-mining-python/"> Chapter 16:   Twitter Data </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                    </ul>


            

            <!-- This is for the activate section in the nav which is grey -->

            

    

            <!-- Only list the week if it's not the week for the current landing page -->
            
                <li> <b>SECTION 8 <a href="http://localhost:4000/courses/use-data-open-source-python/earth-data-science-workflows/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
                 EARTH DATA SCIENCE WORKFLOWS</a></b>
                </li>

                    <!-- list the chapters for each section  updating this to show a chapter number if it's a textbook-->
                    
                     <ul>
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/earth-data-science-workflows/design-efficient-automated-data-workflows/"> Chapter 12:   Design and Automate Data Workflows </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                    </ul>


            

            <!-- This is for the activate section in the nav which is grey -->

            

    

            <!-- Only list the week if it's not the week for the current landing page -->
            
                <li> <b>SECTION 9 <a href="http://localhost:4000/courses/use-data-open-source-python/data-stories/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
                 DATA STORIES</a></b>
                </li>

                    <!-- list the chapters for each section  updating this to show a chapter number if it's a textbook-->
                    
                     <ul>
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/data-stories/colorado-floods-2013/"> Chapter 20:   Flood overview  </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/data-stories/what-is-lidar-data/"> Chapter 21:   Intro to Lidar Data </a>
                                </li>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <li>
                                    <a href="http://localhost:4000/courses/use-data-open-source-python/data-stories/cold-springs-wildfire/"> Chapter 22:   Wildfire Overview </a>
                                </li>
                            
                        
                            
                        
                            
                        
                    </ul>


            

            <!-- This is for the activate section in the nav which is grey -->

            

    
  </ul></li>
 </ul>


 <ul>
   <li><span class="nav__sub-title"><i class="fa fa-folder-open" aria-hidden="true"></i> Overview</span>
    <ul>
     
          
         <li> <a href="http://localhost:4000/courses/use-data-open-source-python/">
           Use Data for Earth and Environmental Science in Open Source Python Home </a></li>
         

     
   </ul>
 </li>
</ul>
</nav>

<h5><a href="http://localhost:4000/courses/intermediate-earth-data-science-textbook/" ><i class="fa fa-home" aria-hidden="true"></i> intermediate-earth-data-science-textbook Home</a></h5>

    

    

  
  </div>






<!-- begin science / science themes side bar nav -->



  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">

    <meta itemprop="headline" content="Extract Raster Values at Point Locations in Python">
    <meta itemprop="description" content="For many scientific analyses, it is helpful to be able to select raster pixels based on their relationship to a vector dataset (e.g. locations, boundaries). Learn how to extract data from a raster dataset using a vector dataset.">
    <meta itemprop="datePublished" content="December 06, 2016">
    <meta itemprop="dateModified" content="February 02, 2021">

    <div class="page__inner-wrap">
        <header>
          

          <!-- BEGIN: insert a welcome to the module block on pages that are part of a module set -->

          <!-- END: insert welcome block -->

          
              

            
                <h1 class="page__title" itemprop="headline">
                Lesson 2. 
                 Extract Raster Values at Point Locations in Python

                
                </h1>
            

          

          
            <div class="page__meta">
              
              
              <a href="http://localhost:4000/authors/leah-wasser">Leah Wasser</a>, 
              
              
              <a href="http://localhost:4000/authors/chris-holdgraf">Chris Holdgraf</a>, 
              
              
              <a href="http://localhost:4000/authors/carson-farmer">Carson Farmer</a>, 
              
              
              <a href="http://localhost:4000/authors/nathan-korinek">Nathan Korinek</a>
              
            </div>
          

            <br/>

            

              
            

            <!-- For tools pages add authors and tool title -->

            
        </header>



      <section class="page__content" itemprop="text">

        <!-- would like to include the TOC automatically but this does weird things-->
        
          
            <aside class="sidebar__right">
<nav class="toc">
    <header><h4 class="nav__title"><i class="fa fa-file-text"></i> On This Page</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#learning-objectives" id="markdown-toc-learning-objectives"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Learning Objectives</a></li>
  <li><a href="#import-canopy-height-model" id="markdown-toc-import-canopy-height-model">Import Canopy Height Model</a></li>
  <li><a href="#clean-up-data---remove-0s" id="markdown-toc-clean-up-data---remove-0s">Clean Up Data - Remove 0’s</a></li>
  <li><a href="#import-plot-location-data--create-buffer" id="markdown-toc-import-plot-location-data--create-buffer">Import Plot Location Data &amp; Create Buffer</a></li>
  <li><a href="#create-a-buffer-around-each-plot-point-location" id="markdown-toc-create-a-buffer-around-each-plot-point-location">Create A Buffer Around Each Plot Point Location</a></li>
  <li><a href="#extract-pixel-values-for-each-plot" id="markdown-toc-extract-pixel-values-for-each-plot">Extract Pixel Values For Each Plot</a></li>
  <li><a href="#optional--explore-the-data-distribution" id="markdown-toc-optional--explore-the-data-distribution">OPTIONAL – Explore The Data Distribution</a></li>
</ul>

  </nav>
</aside>

<div class="notice--success">

  <h2 id="learning-objectives"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Learning Objectives</h2>

  <ul>
    <li>Use the <code class="highlighter-rouge">rasterstats.zonal_stats()</code> function to extract raster pixel values using a vector extent or set of extents.</li>
  </ul>

</div>

<p>On this page, you will extract pixel values that cover each field plot area where trees were measured in the NEON Field Sites. The idea is that you can calculate the mean or max height value for all pixels that fall in each NEON site.</p>

<p>Then, you will compare that mean or max height value derived from the lidar data derived canopy height model pixels to height values calculated using human tree height measurements.</p>

<p>To do this, you need to do the following:</p>

<ol>
  <li>Import the canopy height model that you wish to extra tree height data from.</li>
  <li>Clean up that data. For instance if there are values of 0 for areas where there are no trees they will impact a mean value calculation. It is better to remove those values from the data.</li>
  <li>Finally you will import and create a buffer zone that represents the area where trees were sampled in each NEON field site.</li>
</ol>

<p>To begin, import your python libraries.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">numpy.ma</span> <span class="k">as</span> <span class="n">ma</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">rioxarray</span> <span class="k">as</span> <span class="n">rxr</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">plotting_extent</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="n">gpd</span>
<span class="c1"># Rasterstats contains the zonalstatistics function
# that you will use to extract raster values
</span><span class="kn">import</span> <span class="nn">rasterstats</span> <span class="k">as</span> <span class="n">rs</span>
<span class="kn">import</span> <span class="nn">earthpy</span> <span class="k">as</span> <span class="n">et</span>
<span class="kn">import</span> <span class="nn">earthpy.plot</span> <span class="k">as</span> <span class="n">ep</span>

<span class="c1"># Set consistent plotting style
</span><span class="n">sns</span><span class="p">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">"white"</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1"># Download data and set working directory
</span><span class="n">data</span> <span class="o">=</span> <span class="n">et</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">get_data</span><span class="p">(</span><span class="s">"spatial-vector-lidar"</span><span class="p">)</span>
<span class="n">os</span><span class="p">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">et</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">HOME</span><span class="p">,</span> 
                      <span class="s">'earth-analytics'</span><span class="p">,</span> 
                      <span class="s">'data'</span><span class="p">))</span>
</code></pre></div></div>

<h2 id="import-canopy-height-model">Import Canopy Height Model</h2>

<p>First, you will import a canopy height model created by the National Ecological Observatory Network (NEON). In the
previous lessons / weeks you learned how to make a canopy height model by
subtracting the Digital elevation model (DEM) from the Digital surface model (DSM).</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load &amp; plot the data
</span><span class="n">sjer_lidar_chm_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">"spatial-vector-lidar"</span><span class="p">,</span>
                                   <span class="s">"california"</span><span class="p">,</span> 
                                   <span class="s">"neon-sjer-site"</span><span class="p">,</span>
                                   <span class="s">"2013"</span><span class="p">,</span> 
                                   <span class="s">"lidar"</span><span class="p">,</span> 
                                   <span class="s">"SJER_lidarCHM.tif"</span><span class="p">)</span>

<span class="n">sjer_chm_data</span> <span class="o">=</span> <span class="n">rxr</span><span class="p">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">sjer_lidar_chm_path</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">squeeze</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Explore the data by plotting a histogram with earthpy
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ep</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">sjer_chm_data</span><span class="p">.</span><span class="n">values</span><span class="p">,</span>
             <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
             <span class="n">colors</span><span class="o">=</span><span class="s">"purple"</span><span class="p">,</span>
             <span class="n">xlabel</span><span class="o">=</span><span class="s">"Lidar Estimated Tree Height (m)"</span><span class="p">,</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s">"Total Pixels"</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="s">"Distribution of Pixel Values </span><span class="se">\n</span><span class="s"> Lidar Canopy Height Model"</span><span class="p">)</span>

<span class="c1"># Turn off scientific notation
</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">useOffset</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">style</span><span class="o">=</span><span class="s">'plain'</span><span class="p">)</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000/images/courses/intermediate-eds-textbook/04-spatial-data-applications/remote-sensing-uncertainty/2016-12-06-uncertainty02-extract-raster-values/2016-12-06-uncertainty02-extract-raster-values_6_0.png" alt="Bar plot showing the distribution of lidar chm values." />
<figcaption>Bar plot showing the distribution of lidar chm values.</figcaption>

</figure>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># EXPLORE: View summary statistics of canopy height model
# Notice the mean value with 0's included in the data
</span><span class="k">print</span><span class="p">(</span><span class="s">'Mean:'</span><span class="p">,</span> <span class="n">sjer_chm_data</span><span class="p">.</span><span class="n">mean</span><span class="p">().</span><span class="n">values</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Max:'</span><span class="p">,</span> <span class="n">sjer_chm_data</span><span class="p">.</span><span class="nb">max</span><span class="p">().</span><span class="n">values</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Min:'</span><span class="p">,</span> <span class="n">sjer_chm_data</span><span class="p">.</span><span class="nb">min</span><span class="p">().</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Mean: 1.935588211544547
Max: 45.87999725341797
Min: 0.0
</code></pre></div></div>

<h2 id="clean-up-data---remove-0s">Clean Up Data - Remove 0’s</h2>
<p>Looking at the distribution of data, you can see there are many pixels that have a value of 0 - where there are no trees. Also, using the NEON data, values below 2m are normally set to 0 given the accuracy of the lidar instrument used to collect these data.</p>

<p>Set all pixel values <code class="highlighter-rouge">==0</code> to <code class="highlighter-rouge">nan</code> as they will impact calculation of plot mean height. You can do this with the <code class="highlighter-rouge">.where</code> argument that is available on all <code class="highlighter-rouge">xarray</code> objects. Set a condition, and the <code class="highlighter-rouge">.where</code> function will replace all values that <strong>DON’T</strong> meet that condition with the value provided. For example, <code class="highlighter-rouge">xarray_object = xarray_object.where(xarray_object == 1, 2)</code> will replace all values that <strong>ARE NOT</strong> equal to one with a two. A mean calculated with values of 0 will be significantly lower than a mean calculated with just tree height values.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># CLEANUP: Set CHM values of 0 to NAN (no data or not a number)
</span><span class="n">sjer_chm_data_no_zeros</span> <span class="o">=</span> <span class="n">sjer_chm_data</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">sjer_chm_data</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">)</span>
<span class="c1"># View summary statistics of canopy height model after cleaning up the data
</span><span class="k">print</span><span class="p">(</span><span class="s">'Mean:'</span><span class="p">,</span> <span class="n">sjer_chm_data_no_zeros</span><span class="p">.</span><span class="n">mean</span><span class="p">().</span><span class="n">values</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Max:'</span><span class="p">,</span> <span class="n">sjer_chm_data_no_zeros</span><span class="p">.</span><span class="nb">max</span><span class="p">().</span><span class="n">values</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Min:'</span><span class="p">,</span> <span class="n">sjer_chm_data_no_zeros</span><span class="p">.</span><span class="nb">min</span><span class="p">().</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Mean: 8.213513046063266
Max: 45.87999725341797
Min: 2.0
</code></pre></div></div>

<p>Look at the histogram of the data with the 0’s removed. Now you can see the true distribution of heights in the data without the 0’s.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Explore the data by plotting a histogram with earthpy
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ep</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">sjer_chm_data_no_zeros</span><span class="p">.</span><span class="n">values</span><span class="p">,</span>
             <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
             <span class="n">colors</span><span class="o">=</span><span class="s">"purple"</span><span class="p">,</span>
             <span class="n">xlabel</span><span class="o">=</span><span class="s">"Lidar Estimated Tree Height (m)"</span><span class="p">,</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s">"Total Pixels"</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="s">"Distribution of Pixel Values </span><span class="se">\n</span><span class="s"> Lidar Canopy Height Model"</span><span class="p">)</span>

<span class="c1"># Turn off scientific notation
</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">useOffset</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">style</span><span class="o">=</span><span class="s">'plain'</span><span class="p">)</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000/images/courses/intermediate-eds-textbook/04-spatial-data-applications/remote-sensing-uncertainty/2016-12-06-uncertainty02-extract-raster-values/2016-12-06-uncertainty02-extract-raster-values_11_0.png" alt="Bar plot showing the distribution of lidar chm values with 0's removed." />
<figcaption>Bar plot showing the distribution of lidar chm values with 0's removed.</figcaption>

</figure>

<h2 id="import-plot-location-data--create-buffer">Import Plot Location Data &amp; Create Buffer</h2>

<p>You now have a cleaned canopy height model for your study area in California. However, how
do the height values extracted from the CHM compare to our manually collected,
field measured canopy height data? To figure this out, you will use <em>in situ</em> collected
tree height data, measured within circular plots across our study area. You will compare
the maximum measured tree height value to the maximum LiDAR derived height value
for each circular plot using regression.</p>

<p>First, import the shapefile that contains the plot centroid (the center point of each plot) locations using geopandas.</p>

<p><code class="highlighter-rouge">spatial-vector-lidar/california/neon-sjer-site/vector_data/SJER_plot_centroids.shp</code></p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sjer_centroids_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">"spatial-vector-lidar"</span><span class="p">,</span>
                                   <span class="s">"california"</span><span class="p">,</span> 
                                   <span class="s">"neon-sjer-site"</span><span class="p">,</span>
                                   <span class="s">"vector_data"</span><span class="p">,</span> 
                                   <span class="s">"SJER_plot_centroids.shp"</span><span class="p">)</span>

<span class="n">sjer_plots_points</span> <span class="o">=</span> <span class="n">gpd</span><span class="p">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">sjer_centroids_path</span><span class="p">)</span>

<span class="nb">type</span><span class="p">(</span><span class="n">sjer_plots_points</span><span class="p">)</span>
</code></pre></div></div>

<div class="output execute_result highlighter-rouge"><div class="highlight"><pre class="highlight"><code>geopandas.geodataframe.GeoDataFrame
</code></pre></div></div>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Ensure this is a points layer as you think it is
</span><span class="n">sjer_plots_points</span><span class="p">.</span><span class="n">geom_type</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="output execute_result highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0    Point
1    Point
2    Point
3    Point
4    Point
dtype: object
</code></pre></div></div>

<h3 id="overlay-points-on-top-of-your-raster-data">Overlay Points on Top Of Your Raster Data</h3>

<p>Finally, a quick plot allows you to check that your points actually overlay on top of the canopy 
height model. This is a good sanity check just to ensure your data actually line up and are for the 
same location.</p>

<p>We have previously discussed the spatial extent of a raster. Here is where you will need to set the spatial 
extent when plotting raster using <code class="highlighter-rouge">ep.plot_bands</code>. If you do not specify a spatial extent, your raster will not line up properly with your geopandas object.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># We plot with the zeros in the data so the CHM can be better represented visually
</span><span class="n">ep</span><span class="p">.</span><span class="n">plot_bands</span><span class="p">(</span><span class="n">sjer_chm_data</span><span class="p">,</span>
              <span class="n">extent</span><span class="o">=</span><span class="n">plotting_extent</span><span class="p">(</span><span class="n">sjer_chm_data</span><span class="p">,</span>
                                     <span class="n">sjer_chm_data</span><span class="p">.</span><span class="n">rio</span><span class="p">.</span><span class="n">transform</span><span class="p">()),</span>  <span class="c1"># Set spatial extent
</span>              <span class="n">cmap</span><span class="o">=</span><span class="s">'Greys'</span><span class="p">,</span>
              <span class="n">title</span><span class="o">=</span><span class="s">"San Joachin Field Site </span><span class="se">\n</span><span class="s"> Vegetation Plot Locations"</span><span class="p">,</span>
              <span class="n">scale</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
              <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">sjer_plots_points</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                       <span class="n">marker</span><span class="o">=</span><span class="s">'s'</span><span class="p">,</span>
                       <span class="n">markersize</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
                       <span class="n">color</span><span class="o">=</span><span class="s">'purple'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000/images/courses/intermediate-eds-textbook/04-spatial-data-applications/remote-sensing-uncertainty/2016-12-06-uncertainty02-extract-raster-values/2016-12-06-uncertainty02-extract-raster-values_16_0.png" alt="Map showing SJER plot location points overlayed on top of the SJER Canopy Height Model." />
<figcaption>Map showing SJER plot location points overlayed on top of the SJER Canopy Height Model.</figcaption>

</figure>

<h2 id="create-a-buffer-around-each-plot-point-location">Create A Buffer Around Each Plot Point Location</h2>

<p>Each point in your data represent the center location of a plot where trees were measured. You want to extract tree height values derived from the lidar data for the entire plot. To do this, you will need to create a BUFFER around the points representing the region of the plot where data were collected.</p>

<p>In this case, your plot size is 40m. If you create a circular buffer with a 20m diameter, it will closely approximate where trees were measured on the ground.</p>

<p>You can use the <code class="highlighter-rouge">.buffer()</code> method to create the buffer. Here the buffer size is specified in the <code class="highlighter-rouge">()</code> of the function. You will send the new object to a new shapefile using <code class="highlighter-rouge">.to_file()</code> as follows:</p>

<p><code class="highlighter-rouge">SJER_plots.buffer(20).to_file('path-to-shapefile-here.shp')</code></p>

<figure>
   <a href="http://localhost:4000/images/courses/earth-analytics/spatial-data/buffer-circular.png">
   <img src="http://localhost:4000/images/courses/earth-analytics/spatial-data/buffer-circular.png" alt="national geographic scaling trees graphic" /></a>
   <figcaption>The buffer function in GeoPandas allows you to specify a circular buffer
    radius around an x,y point location. We can than use the zonalstats function in 
    rasterstats to find the maximum value of a raster that's within each buffer we've
    created. Source: Colin Williams, NEON
    </figcaption>
</figure>

<p>Below you:</p>
<ol>
  <li>Make a copy of the points layer that will become a new polygon layer.</li>
  <li>Buffer the points layer using the <code class="highlighter-rouge">.buffer()</code> method. This will produce a circle around each point that is x units radius. The units will coincide with the CRS of your data. This is known as a buffer.</li>
  <li>When you perform the buffer, you UPDATE the “geometry” column of your new poly layer with the buffer output.</li>
</ol>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create a buffered polygon layer from your plot location points
</span><span class="n">sjer_plots_poly</span> <span class="o">=</span> <span class="n">sjer_plots_points</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Buffer each point using a 20 meter circle radius
# and replace the point geometry with the new buffered geometry
</span><span class="n">sjer_plots_poly</span><span class="p">[</span><span class="s">"geometry"</span><span class="p">]</span> <span class="o">=</span> <span class="n">sjer_plots_points</span><span class="p">.</span><span class="n">geometry</span><span class="p">.</span><span class="nb">buffer</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">sjer_plots_poly</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="output execute_result">
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Plot_ID</th>
      <th>Point</th>
      <th>northing</th>
      <th>easting</th>
      <th>plot_type</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SJER1068</td>
      <td>center</td>
      <td>4111567.818</td>
      <td>255852.376</td>
      <td>trees</td>
      <td>POLYGON ((255872.376 4111567.818, 255872.280 4...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>SJER112</td>
      <td>center</td>
      <td>4111298.971</td>
      <td>257406.967</td>
      <td>trees</td>
      <td>POLYGON ((257426.967 4111298.971, 257426.871 4...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>SJER116</td>
      <td>center</td>
      <td>4110819.876</td>
      <td>256838.760</td>
      <td>grass</td>
      <td>POLYGON ((256858.760 4110819.876, 256858.664 4...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SJER117</td>
      <td>center</td>
      <td>4108752.026</td>
      <td>256176.947</td>
      <td>trees</td>
      <td>POLYGON ((256196.947 4108752.026, 256196.851 4...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SJER120</td>
      <td>center</td>
      <td>4110476.079</td>
      <td>255968.372</td>
      <td>grass</td>
      <td>POLYGON ((255988.372 4110476.079, 255988.276 4...</td>
    </tr>
  </tbody>
</table>
</div>

<p>Finally, export the buffered layer as a new shapefile. You will use this layer when you use the zonalstats function.
Below you first check to ensure the outputs directory exists that you wish to write your data to. Then you export the data using the <code class="highlighter-rouge">to_file</code> method.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># If the dir does not exist, create it
</span><span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">"spatial-vector-lidar"</span><span class="p">,</span> 
                           <span class="s">"outputs"</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">output_path</span><span class="p">):</span>
    <span class="n">os</span><span class="p">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>

<span class="c1"># Export the buffered point layer as a shapefile to use in zonal stats
</span><span class="n">plot_buffer_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> 
                                <span class="s">"plot_buffer.shp"</span><span class="p">)</span>

<span class="n">sjer_plots_poly</span><span class="p">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">plot_buffer_path</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="extract-pixel-values-for-each-plot">Extract Pixel Values For Each Plot</h2>

<p>Once you have the boundary for each plot location (a 20m diameter circle) you can extract all of the pixels that fall within each circle using the function <code class="highlighter-rouge">zonal_stats</code> in the <code class="highlighter-rouge">rasterstats</code> library.</p>

<p>There are several ways to use the zonal_stats function. In this case we are providing the following</p>

<ol>
  <li>chm data (numpy array): <code class="highlighter-rouge">sjer_chm_data_no_zeros</code> in a numpy array format (you can turn an xarray object into a numpy array by adding <code class="highlighter-rouge">.values</code> after the object name, for example, <code class="highlighter-rouge">sjer_chm_data_no_zeros</code> is an xarray object, and <code class="highlighter-rouge">sjer_chm_data_no_zeros.values</code> is the numpy version of the same data.</li>
  <li>Because a numpy array has no spatial information, you provide the affine data which is the spatial information needed to spatially located the array.</li>
  <li><code class="highlighter-rouge">plot_buffer_path</code>: this is the path to the buffered point shapefile that you created at the top of this lesson</li>
</ol>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Extract zonal stats
</span><span class="n">sjer_tree_heights</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="n">zonal_stats</span><span class="p">(</span><span class="n">plot_buffer_path</span><span class="p">,</span>
                                   <span class="n">sjer_chm_data_no_zeros</span><span class="p">.</span><span class="n">values</span><span class="p">,</span>
                                   <span class="n">nodata</span><span class="o">=-</span><span class="mi">999</span><span class="p">,</span>
                                   <span class="n">affine</span><span class="o">=</span><span class="n">sjer_chm_data_no_zeros</span><span class="p">.</span><span class="n">rio</span><span class="p">.</span><span class="n">transform</span><span class="p">(),</span>
                                   <span class="n">geojson_out</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                   <span class="n">copy_properties</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                   <span class="n">stats</span><span class="o">=</span><span class="s">"count min mean max median"</span><span class="p">)</span>

<span class="c1"># View object type
</span><span class="nb">type</span><span class="p">(</span><span class="n">sjer_tree_heights</span><span class="p">)</span>
</code></pre></div></div>

<div class="output execute_result highlighter-rouge"><div class="highlight"><pre class="highlight"><code>list
</code></pre></div></div>

<p>Convert the list output to a geodataframe that you can plot the data.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Turn extracted data into a pandas geodataframe
</span><span class="n">sjer_lidar_height_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="p">.</span><span class="n">GeoDataFrame</span><span class="p">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">sjer_tree_heights</span><span class="p">)</span>
<span class="n">sjer_lidar_height_df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="output execute_result">
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>Plot_ID</th>
      <th>Point</th>
      <th>northing</th>
      <th>easting</th>
      <th>plot_type</th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
      <th>count</th>
      <th>median</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>POLYGON ((255872.376 4111567.818, 255872.280 4...</td>
      <td>SJER1068</td>
      <td>center</td>
      <td>4111567.818</td>
      <td>255852.376</td>
      <td>trees</td>
      <td>2.04</td>
      <td>19.049999</td>
      <td>11.544348</td>
      <td>161</td>
      <td>12.62</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POLYGON ((257426.967 4111298.971, 257426.871 4...</td>
      <td>SJER112</td>
      <td>center</td>
      <td>4111298.971</td>
      <td>257406.967</td>
      <td>trees</td>
      <td>2.10</td>
      <td>24.019999</td>
      <td>10.369277</td>
      <td>443</td>
      <td>7.87</td>
    </tr>
    <tr>
      <th>2</th>
      <td>POLYGON ((256858.760 4110819.876, 256858.664 4...</td>
      <td>SJER116</td>
      <td>center</td>
      <td>4110819.876</td>
      <td>256838.760</td>
      <td>grass</td>
      <td>2.82</td>
      <td>16.070000</td>
      <td>7.518398</td>
      <td>643</td>
      <td>6.80</td>
    </tr>
    <tr>
      <th>3</th>
      <td>POLYGON ((256196.947 4108752.026, 256196.851 4...</td>
      <td>SJER117</td>
      <td>center</td>
      <td>4108752.026</td>
      <td>256176.947</td>
      <td>trees</td>
      <td>3.24</td>
      <td>11.059999</td>
      <td>7.675347</td>
      <td>245</td>
      <td>7.93</td>
    </tr>
    <tr>
      <th>4</th>
      <td>POLYGON ((255988.372 4110476.079, 255988.276 4...</td>
      <td>SJER120</td>
      <td>center</td>
      <td>4110476.079</td>
      <td>255968.372</td>
      <td>grass</td>
      <td>3.38</td>
      <td>5.740000</td>
      <td>4.591176</td>
      <td>17</td>
      <td>4.45</td>
    </tr>
  </tbody>
</table>
</div>

<p>Below is a bar plot of max lidar derived tree height by plot id. This plot allows you to see how vegetation height varies across the field sites.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">ax</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">sjer_lidar_height_df</span><span class="p">[</span><span class="s">'Plot_ID'</span><span class="p">],</span>
       <span class="n">sjer_lidar_height_df</span><span class="p">[</span><span class="s">'max'</span><span class="p">],</span>
       <span class="n">color</span><span class="o">=</span><span class="s">"purple"</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s">'Plot ID'</span><span class="p">,</span> 
       <span class="n">ylabel</span><span class="o">=</span><span class="s">'Max Height'</span><span class="p">,</span>
       <span class="n">title</span><span class="o">=</span><span class="s">'Maximum LIDAR Derived Tree Heights'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="p">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">'right'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000/images/courses/intermediate-eds-textbook/04-spatial-data-applications/remote-sensing-uncertainty/2016-12-06-uncertainty02-extract-raster-values/2016-12-06-uncertainty02-extract-raster-values_26_0.png" alt="Bar plot showing maximum tree height per plot in SJER." />
<figcaption>Bar plot showing maximum tree height per plot in SJER.</figcaption>

</figure>

<hr />

<div class="notice--info">

  <h2 id="optional--explore-the-data-distribution">OPTIONAL – Explore The Data Distribution</h2>

  <p>You will not need to perform the steps below for this weeks homework. However, 
if you were really working with lidar data, you may want to look at the distribution
of pixels in each extracted set of cells for further analysis. The steps below show you how to do this.</p>

  <p>If you want to explore the data distribution of pixel height values in each plot,
<code class="highlighter-rouge">rasterstats</code> includes the datapoints corresponding to each zone. To access
this, we included the <code class="highlighter-rouge">raster_out</code> keyword argument when we calculated the
raster stats.</p>

  <p>The <code class="highlighter-rouge">raster_out</code> argument creates a small raster with just the pixel values for each individual plot. You can then plot a histogram of each plot to assess the distribution of data values. This step is helpful if you need to further
explore your data to identify potential issues or to better understand what is going on in the data.</p>

  <p>Below you loop through the points included in each zone and show a histogram
of its values. Note that each set of points is stored as a <em>masked array</em>. This
is because images must be shaped as squares, while our zone may be any
shape that we wish. The mask tells us which pixels fall into the zone.</p>

</div>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Extract zonal stats but retain the individual pixel values
</span><span class="n">sjer_tree_heights_ras</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="n">zonal_stats</span><span class="p">(</span><span class="n">plot_buffer_path</span><span class="p">,</span>
                                       <span class="n">sjer_chm_data_no_zeros</span><span class="p">.</span><span class="n">values</span><span class="p">,</span>
                                       <span class="n">nodata</span><span class="o">=-</span><span class="mi">999</span><span class="p">,</span>
                                       <span class="n">affine</span><span class="o">=</span><span class="n">sjer_chm_data_no_zeros</span><span class="p">.</span><span class="n">rio</span><span class="p">.</span><span class="n">transform</span><span class="p">(),</span>
                                       <span class="n">geojson_out</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                       <span class="n">raster_out</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                       <span class="n">copy_properties</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                       <span class="n">stats</span><span class="o">=</span><span class="s">"count min mean max median"</span><span class="p">)</span>
<span class="c1"># Convert to geodataframe
</span><span class="n">sjer_lidar_height_df_ras</span> <span class="o">=</span> <span class="n">gpd</span><span class="p">.</span><span class="n">GeoDataFrame</span><span class="p">.</span><span class="n">from_features</span><span class="p">(</span>
    <span class="n">sjer_tree_heights_ras</span><span class="p">)</span>

<span class="c1"># View subset of the dataframe
</span><span class="n">sjer_lidar_height_df_ras</span><span class="p">[[</span><span class="s">"Plot_ID"</span><span class="p">,</span> 
                          <span class="s">"count"</span><span class="p">,</span> 
                          <span class="s">"geometry"</span><span class="p">,</span>
                          <span class="s">"mini_raster_affine"</span><span class="p">,</span> 
                          <span class="s">"mini_raster_array"</span><span class="p">]].</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="output execute_result">
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Plot_ID</th>
      <th>count</th>
      <th>geometry</th>
      <th>mini_raster_affine</th>
      <th>mini_raster_array</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SJER1068</td>
      <td>161</td>
      <td>POLYGON ((255872.376 4111567.818, 255872.280 4...</td>
      <td>(1.0, 0.0, 255832.0, 0.0, -1.0, 4111588.0, 0.0...</td>
      <td>[[--, --, --, --, --, --, --, --, --, --, --, ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>SJER112</td>
      <td>443</td>
      <td>POLYGON ((257426.967 4111298.971, 257426.871 4...</td>
      <td>(1.0, 0.0, 257386.0, 0.0, -1.0, 4111319.0, 0.0...</td>
      <td>[[--, --, --, --, --, --, --, --, --, --, --, ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>SJER116</td>
      <td>643</td>
      <td>POLYGON ((256858.760 4110819.876, 256858.664 4...</td>
      <td>(1.0, 0.0, 256818.0, 0.0, -1.0, 4110840.0, 0.0...</td>
      <td>[[--, --, --, --, --, --, --, --, --, --, --, ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SJER117</td>
      <td>245</td>
      <td>POLYGON ((256196.947 4108752.026, 256196.851 4...</td>
      <td>(1.0, 0.0, 256156.0, 0.0, -1.0, 4108773.0, 0.0...</td>
      <td>[[--, --, --, --, --, --, --, --, --, --, --, ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SJER120</td>
      <td>17</td>
      <td>POLYGON ((255988.372 4110476.079, 255988.276 4...</td>
      <td>(1.0, 0.0, 255948.0, 0.0, -1.0, 4110497.0, 0.0...</td>
      <td>[[--, --, --, --, --, --, --, --, --, --, --, ...</td>
    </tr>
  </tbody>
</table>
</div>

<p>Below you create a plot for each individual field site of all pixel values using <code class="highlighter-rouge">earthpy</code>.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Get list of sites
</span><span class="n">site_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sjer_lidar_height_df_ras</span><span class="p">[</span><span class="s">"Plot_ID"</span><span class="p">])</span>

<span class="c1"># Convert data in dataframe to a numpy array
</span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">stack</span><span class="p">(</span><span class="n">sjer_lidar_height_df_ras</span><span class="p">[</span><span class="s">'mini_raster_array'</span><span class="p">])</span>

<span class="c1"># Plot using earthpy
</span><span class="n">ep</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span>
        <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
        <span class="n">cols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">site_names</span><span class="p">,</span> 
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000/images/courses/intermediate-eds-textbook/04-spatial-data-applications/remote-sensing-uncertainty/2016-12-06-uncertainty02-extract-raster-values/2016-12-06-uncertainty02-extract-raster-values_30_0.png" alt="Bar plots showing pixel value distribution for all SJER sites." />
<figcaption>Bar plots showing pixel value distribution for all SJER sites.</figcaption>

</figure>


          

        

        <!-- if the page is a course lesson, add pagination -->

        
         <!-- This is clunky code that forces pagination across lesson sets -->
<!-- NOTE: it won't include slideshows as written which makes sense -->
<!-- add forced pagination -->
<!-- first, get total lesson count -->

<div class="previous--next">





<!-- if it's page one - then no previous button -->
<!-- how do i figure out the link? i have to loop through again? -->


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
       <a href="http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/summarize-and-compare-lidar-insitu-tree-height/" class="btn btn--info btn--large btn-success" style="float:right" >
         Compare Lidar to Measured Tree Height
         <i class="fa fa-4 fa-arrow-circle-right" aria-hidden="true"></i></a>
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      
        <a href="http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/" class="btn btn--info btn--large btn-success">
          <i class="fa fa-4 fa-arrow-circle-left fa-4" aria-hidden="true"></i>
          Remote Sensing Uncertainty </a>
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    

</div>

        
      </section>

      <footer class="page__meta">
        
        



  






  

  <i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags
  
  <span class="a-main-tag">
  <i class="fa fa-fw fa-tag" aria-hidden="true"></i><a href=http://localhost:4000/tags/reproducible-science-and-programming/>Reproducible science and programming</a>:
  </span>
  
    
    <a href=http://localhost:4000/tags/reproducible-science-and-programming/python/>python</a> 
    
    
  

  <span class="a-main-tag">
  <i class="fa fa-fw fa-tag" aria-hidden="true"></i><a href=http://localhost:4000/tags/remote-sensing/>Remote sensing</a>:
  </span>
  
    
    <a href=http://localhost:4000/tags/remote-sensing/lidar/>lidar</a> 
    
    
  

  <span class="a-main-tag">
  <i class="fa fa-fw fa-tag" aria-hidden="true"></i><a href=http://localhost:4000/tags/spatial-data-and-gis/>Spatial data and gis</a>:
  </span>
  
    
    <a href=http://localhost:4000/tags/spatial-data-and-gis/raster-data/>raster data</a> 
    
    
  










        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-02-02">February 02, 2021</time></p>
        
        <!-- Add license information w/ DOI to the bottom -->
        
  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  


      </footer>

      


<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/extract-data-from-raster/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/extract-data-from-raster/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/extract-data-from-raster/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/courses/use-data-open-source-python/spatial-data-applications/lidar-remote-sensing-uncertainty/extract-data-from-raster/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
<br><br>
  <a href="http://bit.ly/2jc5SXy" target="_blank">
    <img src="http://localhost:4000/images/earth-data-analytics-professional-certificate-banner.png" alt="Get a professional Certificate in Earth Data Analytics at University of Colorado, Boulder" width="40%"></a>
</section>


       
    </div>

    
      


<div class="page__comments">
  <h4 class="page__comments-title">Leave a Comment</h4>
  
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
    <div class="page__related">
      
        <h4 class="page__related-title">You May Also Enjoy</h4>
      
      <div class="grid__wrapper">
        
          




<div class="grid__item">
  
    <a href="http://localhost:4000/courses/earth-analytics-bootcamp/plot-data-python">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">Plot Data With Matplotlib
</h2>


     
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  1 minute read
	
</p>
      
      <p class="archive__item-excerpt" itemprop="description">

     This Week

  


</p>
    </article>
  </a>
</div>

        
          




<div class="grid__item">
  
    <a href="http://localhost:4000/courses/use-data-open-source-python/hierarchical-data-formats-hdf/summarize-climate-data-by-season/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">Calculate Seasonal Summary Values from Climate Data Variables Stored in NetCDF 4 Format: Work With MACA v2 Climate Data in Python
</h2>


     
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  25 minute read
	
</p>
      
      <p class="archive__item-excerpt" itemprop="description">Learn how to calculate seasonal summary values for MACA 2 climate data using xarray and region mask in open source Python.
</p>
    </article>
  </a>
</div>

        
          




<div class="grid__item">
  
    <a href="http://localhost:4000/courses/use-data-open-source-python/hierarchical-data-formats-hdf/subset-netcdf4-climate-data-spatially-aoi/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">Calculate Summary Values Using Spatial Areas of Interest (AOIs) including Shapefiles for Climate Data Variables Stored in NetCDF 4 Format: Work With MACA v2 Climate Data in Python
</h2>


     
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  33 minute read
	
</p>
      
      <p class="archive__item-excerpt" itemprop="description">Climate datasets stored in netcdf 4 format often cover the entire globe or an entire country. Learn how to subset climate data spatially and by time slices u...</p>
    </article>
  </a>
</div>

        
          




<div class="grid__item">
  
    <a href="http://localhost:4000/courses/use-data-open-source-python/hierarchical-data-formats-hdf/use-netcdf-in-python-xarray/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">How to Open and Process NetCDF 4 Data Format in Open Source Python
</h2>


     
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  26 minute read
	
</p>
      
      <p class="archive__item-excerpt" itemprop="description">Historic and projected climate data are most often stored in netcdf 4 format. Learn how to open and process MACA version 2 climate data for the Continental U...</p>
    </article>
  </a>
</div>

        
      </div>
    </div>
  
</div>



    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->


<!-- Adding analytics code -->

        



<div class="page__footer-follow">
  <ul class="social-icons">
    <li>
      <strong>&copy; 2021 Earth Lab -
      <a href="http://localhost:4000/license"> All materials on this site
        are subject to the CC BY-NC-ND 4.0 License. </a>
      </strong>
    </li>
  </ul>
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/earthlabcu"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/earthlab"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<!--
<div class="page__footer-copyright">Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
-->

      </footer>
    </div>

    <script src="http://localhost:4000/assets/js/main.min.js"></script>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'earthlabcu';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





<script type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>

    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-84081999-1', 'auto');
    ga('send', 'pageview');
</script>



  </body>
</html>

